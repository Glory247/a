"use strict";var OriginalImage=$(".upload-preview,.preview-container").html();$('input[name="image_upload"]').change((function(a){var e=a.target.files[0];if(!e)return $(".upload-preview,.preview-container").html(OriginalImage),void $(this).val("");if(-1==$.inArray(e.name.split(".").pop().toLowerCase(),["jpg","jpeg","png","gif"]))return notyf("Chỉ cho phép tải lên các ảnh có định dạng JPG, JPEG, PNG hoặc GIF.","danger"),$(".upload-preview,.preview-container").html(OriginalImage),void $(this).val("");if(e.size>2097152)return notyf("Kích thước ảnh quá lớn, hãy chọn ảnh nhỏ hơn 2MB!","danger"),$(".upload-preview,.preview-container").html(OriginalImage),void $(this).val("");var t=new FileReader;t.onload=function(a){$(".upload-preview,.preview-container").html('<img class="fit-cover" src="'+a.target.result+'">')},t.readAsDataURL(e)})),$(".avatar-set-link").click((function(){$("#change_avatar_modal").modal("show"),$(".loading-mask").delay(333).fadeOut()})),$(".anhbia-set-link").click((function(){$("#change_anhbia_modal").modal("show"),$(".loading-mask").delay(333).fadeOut()})),$(".anhbia-set-link").click((function(){$("#change_anhbia_modal").modal("show"),$(".loading-mask").delay(333).fadeOut()})),$('[data-toggle="report_modal"]').click((function(){$("#report_modal").modal("show"),$("#report_modal .report-avatar").attr("src",$(this).data("report-avatar")),$("#report_modal .display-name").text($(this).data("report-hovaten")),$("#report_modal .report-profile-link").attr("href",$(this).data("report-username")),$("#report_modal .url-victim").val($(this).data("report-url")),$(".loading-mask").delay(333).fadeOut()})),$('[data-toggle="report_notice"]').click((function(){$("#report_notice").modal("show"),$(".loading-mask").delay(333).fadeOut()}));var maxImages=3,uploadedImages=0,maxImagesReached=!1;$(".td-uploads-report").on("click",(function(){maxImagesReached?notyf("Bạn đã tải lên đủ số lượng ảnh cho phép.","danger"):$('input[name="image_upload_report"]').click()})),$('input[name="image_upload_report"]').on("change",(function(a){var e=a.target;if(e.files&&e.files.length>0)for(var t=maxImages-uploadedImages,o=Math.min(e.files.length,t),n=0;n<o;n++){var i=new FileReader;i.onload=function(a){var e=$('<div class="preview-item"></div>'),t=$('<img src="'+a.target.result+'" alt="Uploaded Image">'),o=$('<div class="preview-remove"><div class="ic-close"></div></div>');o.on("click",(function(){e.css("transition","width 0.4s ease-out, opacity 0.4s ease-out").css("width","0").css("overflow","hidden").css("opacity","0").delay(400).queue((function(a){$(this).remove(),a()})),--uploadedImages<maxImages&&(maxImagesReached=!1,$(".td-uploads-report").show())})),e.append(t),e.append(o),$(".add").before(e),++uploadedImages===maxImages&&(maxImagesReached=!0,$(".td-uploads-report").hide())},i.readAsDataURL(e.files[n])}})),$(".td-upload-avatar").submit((function(a){a.preventDefault();var e=$(this);if(e.find('input[type="file"]').val()){e.find('.modal-buts button[type="submit"]').html('<span class="miniupload-ing"><i class="loading mr3 c-yellow"></i><span class="loading-text c-yellow"> Đang Xử Lý<count class="px12 ml3"></count></span><div class="progress progress-striped active"><div class="progress-bar progress-bar-success" role="progressbar" style="width:0;"></div></div></span>').prop("disabled",!0);var t=new FormData(e[0]);$.ajax({url:"/ajax/users/global.users",type:"POST",data:t,processData:!1,contentType:!1,dataType:"json",success:function(a){a.success?($("#change_avatar_modal").modal("hide"),$(".td-load-avatar").load(location.href+" .td-load-avatar > *"),$(".td-load-avatar2").load(location.href+" .td-load-avatar2 > *"),notyf(a.message,"success")):notyf(a.error,"danger"),e.find('.modal-buts button[type="submit"]').html('<i class="fa fa-check mr10"></i>Xác Nhận').prop("disabled",!1)},error:function(a,t,o){console.error(a.responseText),notyf("Có lỗi xảy ra khi gửi yêu cầu","danger"),e.find('.modal-buts button[type="submit"]').html('<i class="fa fa-check mr10"></i>Xác Nhận').prop("disabled",!1)}})}else notyf("Vui lòng chọn hình ảnh cần upload trước!","warning")})),$(".td-upload-anhbia").submit((function(a){a.preventDefault();var e=$(this);if(e.find('input[type="file"]').val()){e.find('.modal-buts button[type="submit"]').html('<i class="loading mr3 c-yellow"></i><span class="loading-text c-yellow"> Đang Xử Lý</span>').prop("disabled",!0);var t=new FormData(e[0]);$.ajax({url:"/ajax/users/global.users",type:"POST",data:t,processData:!1,contentType:!1,dataType:"json",success:function(a){a.success?($("#change_anhbia_modal").modal("hide"),$(".td-load-anhbia").load(location.href+" .td-load-anhbia > *"),notyf(a.message,"success")):notyf(a.error,"danger"),e.find('.modal-buts button[type="submit"]').html('<i class="fa fa-check mr10"></i>Xác Nhận').prop("disabled",!1)},error:function(a,t,o){console.error(o),notyf("Có lỗi xảy ra khi gửi yêu cầu","danger"),e.find('.modal-buts button[type="submit"]').html('<i class="fa fa-check mr10"></i>Xác Nhận').prop("disabled",!1)}})}else notyf("Vui lòng chọn hình ảnh cần upload trước!","warning")}));