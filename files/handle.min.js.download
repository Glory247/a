function ThanhDieuHandle(e){var a,t,n={};n.ws=$("body");let s=(e,a,t)=>{let n=new Date;n.setTime(n.getTime()+864e5*t),document.cookie=`${e}=${a}; expires=${n.toUTCString()}; path=/`},i=e=>{let a=`; ${document.cookie}`,t=a.split(`; ${e}=`);if(2===t.length)return t.pop().split(";").shift()};setInterval(function(){var e=new Date-new Date($("#span_dt_dt").data("footer-time").replace(/-/g,"/"));$("#span_dt_dt").html('<font style="color:#00ffff">'+Math.floor(e/3154e7)+" năm "+Math.floor(e%3154e7/864e5)+" ng\xe0y "+Math.floor(e%864e5/36e5)+" giờ "+Math.floor(e%36e5/6e4)+" ph\xfat "+Math.floor(e%6e4/1e3)+" gi\xe2y</font>")},1e3);var o=document.getElementById("fps"),c=Date.now(),r=0;if(!function e(){var a=Date.now();r++,a-c>1e3&&(o.innerHTML=(r/((a-c)/1e3)).toFixed(1),c=a,r=0),window.requestAnimationFrame(e)}(),new Swiper(".new-swiper",{direction:"horizontal",loop:!0,effect:"coverflow",autoplay:{delay:6e3,disableOnInteraction:!1},navigation:{nextEl:".new-swiper .swiper-button-next",prevEl:".new-swiper .swiper-button-prev"},pagination:{el:".new-swiper .swiper-pagination",clickable:!0},spaceBetween:15}),new Swiper(".new-swiper-2",{direction:"horizontal",autoplay:{delay:6e3,disableOnInteraction:!1}}),$(".footwaveline").length){var l,d=$("#foot_remake");d.hover(function(){clearInterval(l)},function(){l=setInterval(function(){var e,a,t;e=d,a=e.find("ul"),t=a.find("li:first").height(),a.animate({marginTop:-t+"px"},500,function(){a.css({marginTop:0}).find("li:first").appendTo(a)})},3e3)}).trigger("mouseleave"),window.onscroll=function(){let e=window.pageYOffset,a=document.documentElement.clientHeight,t=Math.round(e/(Math.max(document.body.scrollHeight,document.documentElement.scrollHeight,document.body.offsetHeight,document.documentElement.offsetHeight,document.body.clientHeight,document.documentElement.clientHeight)-a)*100),n=document.querySelector("#percentage");n.innerHTML='<svg class="icon" aria-hidden="true"><use xlink:href="#icon-dingwei"></use></svg> '+t+"%",0==t&&(n.innerHTML='<svg class="icon" aria-hidden="true"><use xlink:href="#icon-dingwei"></use></svg> 0%'),100==t&&(n.innerHTML='<svg class="icon" aria-hidden="true"><use xlink:href="#icon-jiasu1"></use></svg> 100%')}}let u=e=>{let a=document.createElement("div");return a.textContent=e,a.innerHTML},h=(e,a)=>{if(!(e=u(e.trim())))return;let t=i("search_history");if(t)try{t=JSON.parse(t)}catch(n){t=[]}else t=[];let o=t.findIndex(t=>t.keyword===e&&t.type===a);-1!==o&&t.splice(o,1);let c={keyword:e,type:a};t.unshift(c),t.length>12&&(t=t.slice(0,12)),s("search_history",JSON.stringify(t),30),p(t)},p=e=>{let a=$(".search-history-list");a.empty();let t=new Set;$.each(e,function(e,n){if(!t.has(n.keyword)){t.add(n.keyword);let s=$(`<a class="search_keywords muted-2-color but em09 mr6 mb6" href="/search/?q=${encodeURIComponent(n.keyword)}&type=${n.type}">${u(n.keyword)}</a>`);a.append(s)}})};(()=>{let e=new URLSearchParams(window.location.search),a=e.get("q"),t=e.get("type");a&&t?h(a,t):$(".search-keywords.history-search").addClass("hide")})(),$(".trash-history-search").click(function(){s("search_history","",-1),p([])});var m=$(this);class f{static TD(e){return e.find('button[type="submit"]').html('<i class="loading mr3 c-white"></i><span class="loading-text c-white"> Đang Xử L\xfd</span>').prop("disabled",!0)}}class g{static TD(){var e=$("#u_sign").find(".modal-dialog");e.css({"margin-top":Math.max(0,($(window).height()-e.height())/2)})}}$(window).scroll(function(){$(window).scrollTop()>500?$(".back-to-top").css("top","-200px"):$(".back-to-top").css("top","-600px")}),$(".back-to-top").click(function(){$("body,html").animate({scrollTop:0},600)}),$(".td-search").on("input",function(){var e=$(this).val(),a=$('input[name="type"]').val(),t="/search/?q="+encodeURIComponent(e);switch(a){case"code":default:t+="&type=code";break;case"user":t+="&type=user";break;case"forum":t+="&type=forum"}$(".search-form").attr("action",t)});let v=new URLSearchParams(window.location.search);v.has("out")&&"true"===v.get("out")&&v.has("session_data")&&($(".modal:not(#u_sign)").modal("hide"),$("#u_sign").modal("show"),$("#tab-signin-pas").addClass("fade in active"),$('a[href="#tab-sign-in"]').tab("show"),g.TD(),y()),$("[data-fancybox]").length>0&&Fancybox.bind("[data-fancybox]",{});let b=$("div[data-captcha]").data("captcha");function y(){$(".loading-mask").show(),clearInterval(a),a=setInterval(function(){$(".loading-mask").fadeOut()},333+Math.floor(888*Math.random()))}function w(){return!["dang-nhap","dang-ky","login","signup","signin","register","user-auth"].some(e=>window.location.href.toLowerCase().includes(e))}b||notyf("Lỗi x\xe1c thực Captcha GeetestV4.","danger"),window.addEventListener("touchmove",null),$(function(){-1!==window.location.href.indexOf("system")?($(".td-tab-message li").removeClass("active"),$('.td-tab-message li:has(a[href="system"])').addClass("active")):-1!==window.location.href.indexOf("chat")?($(".td-tab-message li").removeClass("active"),$('.td-tab-message li:has(a[href="chat"])').addClass("active")):$(".td-tab-message li:first").addClass("active"),$(".td-tab-message li").click(function(){$(".td-tab-message li").removeClass("active"),$(this).addClass("active")})}),n.ws.on("click",".drawer-close",function(){$(".drawer-sm").css("transition","margin-left 0.7s").css("margin-left","100%"),n.ws.removeClass("drawer-show");var e=window.location.href.lastIndexOf("/user/");if(-1!==e){var a=window.location.href.substring(0,e+6);window.history.replaceState({},document.title,a)}}),n.ws.on("click","button[data-target='navbar-search']",function(){$(".navbar-search").removeClass("show")}),n.ws.on("click","#tupBtn",function(e){e.preventDefault(),notyf("Chức năng tạm đ\xf3ng!","danger")}),n.ws.on("click","[data-toggle='signin-loader']",function(){w()?($(".modal:not(#u_sign)").modal("hide"),$("#u_sign").modal("show"),$('a[href="#tab-sign-in"]').tab("show"),g.TD(),y()):notyf("Bạn đang ở trang n\xe0y rồi!","danger")}),n.ws.on("click",".signin-loader",function(){w()?($(".modal:not(#u_sign)").modal("hide"),$("#u_sign").modal("show"),$('a[href="#tab-sign-in"]').tab("show"),g.TD(),y()):notyf("Bạn đang ở trang n\xe0y rồi!","danger")}),n.ws.on("click",".signup-loader",function(){w()?($(".modal:not(#u_sign)").modal("hide"),$("#u_sign").modal("show"),$('a[href="#tab-sign-up"]').tab("show"),g.TD(),y()):notyf("Bạn đang ở trang n\xe0y rồi!","danger")}),n.ws.on("click",".signpass-loader",function(){w()?($(".modal:not(#u_sign)").modal("hide"),$("#u_sign").modal("show"),$('a[href="#tab-sign-pas"]').tab("show"),g.TD(),y()):notyf("Bạn đang ở trang n\xe0y rồi!","danger")}),n.ws.on("click",".modal-order",function(){$(".modal:not(#modal-order)").modal("hide"),$("#modal-order").modal("show"),y()}),n.ws.on("click",".start-new-posts",function(){$(".modal:not(#not-auth-modal)").modal("hide"),$("#not-auth-modal").modal("show"),y()}),n.ws.on("click",".initiate-muster",function(){$(".modal:not(#diem-danh)").modal("hide"),$("#diem-danh").modal("show"),y()}),n.ws.on("click",".balance-charge-link",function(){$(".modal:not(#naptien_modal)").modal("hide"),$("#naptien_modal").modal("show"),y()}),n.ws.on("click",".user-auth-info",function(){$("#chungnhan_verify_modal").css("z-index",113114+10*$(".modal:visible").length),$("#chungnhan_verify_modal").modal("show"),y()}),n.ws.on("click",".user-details-link",function(){$("#user-details-link").modal("show"),y()}),n.ws.on("click","[data-for='reason']",function(){"other"===$(this).data("other")?$('[data-controller="reason"][data-value="other"]').show():($('[data-controller="reason"][data-value="other"]').hide(),$('[name="reason_other"]').val(""))}),$(".payment-method-radio").click(function(){var e=$(this).data("value");$('.mb10[data-controller="payment_method"]').hide(),$(".payment-method-radio").removeClass("active"),$(this).addClass("active"),$('.mb10[data-condition="=="][data-value="'+e+'"]').show()}),n.ws.on("click",".payment-copy",function(){var e=$(this).val();navigator.clipboard.writeText(e).then(function(){notyf("Đ\xe3 sao ch\xe9p: "+e,"info")}).catch(function(e){notyf("Kh\xf4ng thể sao ch\xe9p: "+e,"warning")})}),$(".touch-close").on("touchstart",function(e){t=e.originalEvent.touches[0].clientY}),$(".touch-close").on("touchmove",function(e){e.originalEvent.touches[0].clientY-t>0&&$("#report_modal").modal("hide")}),$(".touch-close").on("touchend",function(e){t=null});var _={};$(".ajaxpager").on("scroll",function(){_[$(this).attr("id")]=$(this).scrollTop()}),$(".td-tab-balance a").on("click",function(e){e.preventDefault();var a=$(this).attr("href");$(".tab-pane").removeClass("fade").removeClass("in").removeClass("active"),$(a).addClass("fade in active"),$(".td-tab-balance li").removeClass("active"),$(this).parent("li").addClass("active")}),setTimeout(function(){$("#record_tab_balance").addClass("fade in active"),$(".td-active").addClass("active")},0),$("[data-tab-href]").click(function(e){e.preventDefault();var a=$(this).attr("data-tab-href"),t=_[a];void 0!==t&&$("#"+a).scrollTop(t);var n=$(this).attr("data-tab-href"),s=window.location.pathname+"?tab="+n;window.location.href=s}),$(window).on("beforeunload",function(){$(".ajaxpager").each(function(){_[$(this).attr("id")]=$(this).scrollTop()})});let x=Date.now(),k=i("HideModal");(!k||x>parseInt(k))&&$("#modal-system-notice").modal("show"),$(".close-notice").click(()=>{$("#modal-system-notice").modal("hide"),s("HideModal",x+72e5,2)}),$(".ws-copy").click(()=>{navigator.clipboard.writeText($(".ws-copy").attr("data-copy-text")).then(()=>notyf("Đ\xe3 sao ch\xe9p v\xe0o bộ nhớ tạm!","info")).catch(e=>notyf("Kh\xf4ng thể sao ch\xe9p: "+e,"danger"))});var T=new URLSearchParams(window.location.search).get("tab");function j(e){f.TD(m),$.ajax({type:"POST",url:window._thanhdieu.ajax_user,data:e,dataType:"json",success:function(e){m.find('button[type="submit"]').html("Thanh To\xe1n").prop("disabled",!1),e.success?($("#modal_pay_uservip").modal("hide"),notyf(e.message,"success")):notyf(e.error,"danger")},error:function(e,a,t){m.find('button[type="submit"]').html("Thanh To\xe1n").prop("disabled",!1),notyf("Mất kết nối đến m\xe1y chủ!","danger")}})}function C(e){e&&$("#msg-tab-system").html('<div class="post_ajax_loader box-body nopw-sm"><p class="placeholder"></p><p class="placeholder t1"></p><p class="placeholder k1"></p><p class="placeholder k2" style="height:240px"></p><i class="placeholder s1"></i><i class="placeholder s1 ml10"></i></div>')}function D(e,a,t){$.ajax({url:window._thanhdieu.ajax_user,type:"POST",data:{main_products:!0,page:e,tab:a,type:t},dataType:"json",beforeSend:function(){$("#product-list").html("");let e=1;for(;e<=12;)$("#product-list").append($('<div id="product-placeholder" style="display:none;"><div class="posts-item card no-events-img"><div class="item-thumbnail"><div class="radius8 item-thumbnail placeholder"></div></div><div class="item-body"><h2 class="item-excerpt placeholder t1 item-heading"></h2><p class="mt10 placeholder k2"></p><i class="flex jsb"><i class="placeholder s1"></i><i class="placeholder s1 ml10"></i></i></div></div></div>').html()),e++},success:function(e){!0===e.success?($("#product-list").empty(),e.products.forEach(function(e){$("#product-list").append(e)}),$(".ajax-pag").html(e.pagination).show()):($("#product-list").html(""),$("#product-list").append(e.message))},complete:function(){},error:function(e,a,t){notyf("Lỗi! m\xe1y chủ từ chối kết nối.","danger")}})}function S(e,a,t,n){$.ajax({url:window._thanhdieu.ajax_user,type:"POST",data:{profile_products:!0,page:e,type:a,xetduyet:t,author:n},dataType:"json",beforeSend:function(){$("#product-list-2").html("");let e=1;for(;e<=6;)$("#product-list-2").append($('<div id="product-placeholder" style="display:none;"><div class="posts-item flex"><div class="post-graphic"><div class="radius8 item-thumbnail placeholder"></div></div><div class="item-body flex xx flex1 jsb"><p class="placeholder t1"></p><h4 class="item-excerpt placeholder k1"></h4><p class="placeholder k2"></p><i><i class="placeholder s1"></i><i class="placeholder s1 ml10"></i></i></div></div>').html()),e++},success:function(e){!0===e.success?($("#product-list-2").empty(),e.products.forEach(function(e){$("#product-list-2").append(e)}),$(".ajax-pag").html(e.pagination).show()):($("#product-list-2").empty(),$(".ajax-pag").append("").hide(),$("#product-list-2").append(e.message))},complete:function(){},error:function(e,a,t){notyf("Lỗi! m\xe1y chủ từ chối kết nối.","danger")}})}if($("ul.scroll-x li").each(function(){$(this).find("a").attr("href")==="?tab="+T?$(this).hasClass("active")||$(this).addClass("active"):$(this).hasClass("active")&&null!==T&&$(this).removeClass("active")}),null===T&&$("ul.scroll-x li:first-child").addClass("active"),$(window).scroll(function(){if($(window).scrollTop()+$(window).height()>=$(document).height()-.2*$(document).height())$(".crolltop").removeClass("ontop");else{var e=$(".crolltop");e.hasClass("ontop")||e.addClass("ontop")}}),setInterval(function(){$(".geetest_box_logo,.geetest_feedback").hide(),$(".geetest_text_tips").html('<span style="font-family:Rowdies;">Vận h\xe0nh bởi ThanhDieuTV</span>')},0),$(".modal_signout").click(function(){$("#modal_signout").modal("show"),y()}),n.ws.on("click","#Logout",function(e){e.preventDefault();var a=$(this);a.html('<i class="loading zts"></i>'),n.ws.delay(1500).hide(0,function(){$.ajax({url:window._thanhdieu.ajax_user,type:"GET",data:{action:"logout"},success:function(e){let a=new URLSearchParams(window.location.search);a.has("out")&&(a.set("out","false"),window.location.search=a.toString()),n.ws.fadeOut(200,function(){history.go(0)}).fadeIn(200)},error:function(e,t,n){notyf("Lỗi kết nối đến m\xe1y chủ!","danger"),a.text("X\xe1c Nhận")}})})}),jQuery(document).ready(function(){if(document.cookie.includes("remember_me=")){var e=JSON.parse(document.cookie.split("remember_me=")[1].split(";")[0]);$('input[name="username"]').val(e.username),$('input[name="password"]').val(e.password),$("#remember_me").prop("checked",!0)}$('.auth-user-login input[name="username"], .auth-user-login input[name="password"]').on("input",function(){$('.auth-user-login button[type="submit"]').prop("disabled",!$('.auth-user-login input[name="username"]').val()||!$('.auth-user-login input[name="password"]').val())}).trigger("input"),$('.auth-user-register input[name="hovaten"], .auth-user-register input[name="username"], .auth-user-register input[name="password"], .auth-user-register input[name="invite"], .auth-user-register input[name="tos"]').on("input",function(){var e=$(this).closest("form"),a=e.find('button[type="submit"]'),t=e.find('input[name="hovaten"]').val()&&e.find('input[name="username"]').val()&&e.find('input[name="password"]').val()&&e.find('input[name="tos"]').is(":checked");a.prop("disabled",!t)}),n.ws.on("submit",".auth-user-login",function(e){var a=$(this).find('button[type="submit"]');function t(){a.html('<i class="fa fa-sign-in mr10"></i>Đăng Nhập').prop("disabled",!1)}e.preventDefault(),a.html('<i class="ri-loader-4-fill fa fa-spin"></i>').prop("disabled",!0);var s=new FormData($(this)[0]);initGeetest4({captchaId:b,product:"bind",riskType:"slide"},function(e){e.onReady(function(){e.showCaptcha()}),e.onSuccess(function(){var a=e.getValidate();return s.append("geetest_challenge",a.geetest_challenge),s.append("geetest_validate",a.geetest_validate),s.append("geetest_seccode",a.geetest_seccode),$.ajax({type:"POST",url:window._thanhdieu.ajax_user,data:s,processData:!1,contentType:!1,dataType:"json",success:function(a){if(t(),e.reset(),a.status){$("#remember_me").is(":checked")?document.cookie="remember_me="+JSON.stringify({username:s.get("username"),password:s.get("password")})+"; path=/; max-age=2592000":document.cookie="remember_me=; path=/; expires=Thu, 01 Jan 1970 00:00:00 UTC;",n.ws.fadeOut(200,function(){history.go(0)}).fadeIn(200),$("#u_sign").modal("hide");let i=new URLSearchParams(window.location.search);i.has("out")&&"true"===i.get("out")&&(i.set("out","false"),window.location.search=i.toString())}else a.xss?notyf(a.message,"warning"):notyf(a.message,"danger")},error:function(a,n,s){t(),e.reset(),notyf("Mất kết nối đến m\xe1y chủ!","danger")}}),!1}),e.onClose(function(){t(),e.reset(),notyf("Bạn đ\xe3 huỷ bỏ x\xe1c minh captcha!","warning")})})}),n.ws.on("submit",".auth-user-register",function(e){var a=$(this).find('button[type="submit"]');function t(){a.html('<i class="fa fa-sign-in mr10"></i>Đăng Nhập').prop("disabled",!1)}e.preventDefault(),a.html('<i class="ri-loader-4-fill fa fa-spin"></i>').prop("disabled",!0);var n=new FormData($(this)[0]);initGeetest4({captchaId:b,product:"bind",riskType:"slide"},function(e){e.onReady(function(){e.showCaptcha()}),e.onSuccess(function(){return $.ajax({type:"POST",url:window._thanhdieu.ajax_user,data:n,processData:!1,contentType:!1,dataType:"json",success:function(a){t(),e.reset(),a.success?(notyf(a.message,"success"),setTimeout(()=>window.history.replaceState({},document.title,window.location.pathname)||window.location.reload(),1500),$(".modal").each(function(){$(this).modal("hide")})):notyf(a.message,"danger")},error:function(a,n,s){t(),e.reset(),notyf("Mất kết nối đến m\xe1y chủ!","danger")}}),!1}),e.onClose(function(){t(),e.reset(),notyf("Bạn đ\xe3 huỷ bỏ x\xe1c minh captcha!","warning")})})})}),$("#commentform").submit(function(e){e.preventDefault();var a=$("#commentform").serialize();$.ajax({type:"POST",url:window._thanhdieu.ajax_user,data:a,dataType:"json",success:function(e){e.success?(history.go(0),notyf(e.message,"success")):notyf(e.message,"danger")},error:function(e,a,t){return notyf("Mất kết nối đến m\xe1y chủ!","danger"),!1}})}),n.ws.on("click",".smilie-icon",function(){var e=$(this).data("smilie"),a=$("#comment");a.val(a.val()+"[icon="+e+"]"),$(".smilie").removeClass("open")}),n.ws.on("click","#confirm-image",function(){var e=$(".input-textarea").val().trim();if((e.match(/http:\/\//g)||[]).length>1||(e.match(/https:\/\//g)||[]).length>1){notyf("Vui l\xf2ng nhập đ\xfang địa chỉ h\xecnh ảnh","warning");return}""!==e&&/^(https?:\/\/)?(?:www\.)?\S+\.(png|gif|jpg|jpeg)$/i.test(e)?($("#comment").val(function(a,t){return t+"[img="+e+"]"}),$(".image").removeClass("open"),$(".input-textarea").val("")):notyf("Vui l\xf2ng nhập URL h\xecnh ảnh hợp lệ","warning")}),$(".comment-delete-link").click(function(){var e=$(this).data("commentid"),a=$(this).data("is-comments"),t=$(this).data("replyid");$.ajax({url:window._thanhdieu.ajax_user,type:"POST",data:{delete_comment:!0,id_comment:e,is_comments:a,reply_id:t},dataType:"json",success:function(a){a.success?(1==a.is_cmt?$(".reply-id-"+t).remove():$(".cmt-id-"+e).remove(),notyf(a.message,"success")):notyf(a.message,"danger")},error:function(e,a,t){notyf("Lỗi khi xo\xe1 b\xecnh luận n\xe0y!","danger")}})}),$(".action-like").on("click",function(){var e=$(this).data("post-id"),a=$(this).find("count"),t=a.text();a.html('<i class="loading zts"></i>'),$.ajax({url:window._thanhdieu.ajax_user,method:"POST",dataType:"json",data:{ws_like:!0,postId:e},success:function(e){e.success?e.message.includes("th\xe0nh c\xf4ng")?(notyf("Đ\xe3 th\xedch b\xe0i viết n\xe0y!","success"),$(".action-like").addClass("action-animation"),a.text("Th\xedch "+(parseInt(t.replace("Th\xedch ",""))+1))):(notyf(e.message,"warning"),a.text("Th\xedch "+(parseInt(t.replace("Th\xedch ",""))-1))):(a.html(t),notyf(e.message,"danger"))},error:function(e,n,s){a.html(t),notyf("Lỗi khi th\xedch b\xe0i viết n\xe0y!","danger")}})}),$(".action-share").on("click",function(){var e=$(this).data("post-id"),a=$(this).find("count"),t=a.text();a.html('<i class="loading zts"></i>'),$.ajax({url:window._thanhdieu.ajax_user,method:"POST",dataType:"json",data:{ws_share:!0,postId:e},success:function(e){e.success?$(".action-share").load(location.href+" .action-share > *"):notyf(e.message,"danger")},error:function(e,n,s){a.html(t),notyf("Lỗi khi chia sẽ b\xe0i viết n\xe0y!","danger")}})}),$(".td-change-account").submit(function(e){e.preventDefault();var a=$(this);a.find('button[type="submit"]').html('<i class="loading mr3 c-yellow"></i><span class="loading-text c-yellow"> Đang Xử L\xfd</span>').prop("disabled",!0);var t=$(".td-change-account").serialize();$.ajax({type:"POST",url:window._thanhdieu.ajax_user,data:t,dataType:"json",success:function(e){a.find('button[type="submit"]').html('<i class="fa fa-check mr10"></i>Lưu Thay Đổi').prop("disabled",!1),e.success?notyf(e.message,"success"):notyf(e.error,"danger")},error:function(e,t,n){return a.find('button[type="submit"]').html('<i class="fa fa-check mr10"></i>Lưu Thay Đổi').prop("disabled",!1),notyf("Mất kết nối đến m\xe1y chủ!","danger"),!1}})}),n.ws.on("click",".modal-change-password",function(e){$("#change_password_modal").modal("show"),y()}),n.ws.on("submit",".td-change-password",function(e){e.preventDefault();var a=$(this);a.find('button[type="submit"]').html('<i class="loading mr3 c-yellow"></i><span class="loading-text c-yellow"> Đang Xử L\xfd</span>').prop("disabled",!0);var t=$(this).serialize();$.ajax({type:"POST",url:window._thanhdieu.ajax_user,data:t,dataType:"json",success:function(e){a.find('button[type="submit"]').html('<i class="fa fa-check mr10"></i>Đổi Mật Khẩu').prop("disabled",!1),e.success?($("#change_password_modal").modal("hide"),notyf(e.message,"success")):notyf(e.error,"danger")},error:function(e,t,n){return a.find('button[type="submit"]').html('<i class="fa fa-check mr10"></i>Đổi Mật Khẩu').prop("disabled",!1),notyf("Mất kết nối đến m\xe1y chủ!","danger"),!1}})}),n.ws.on("click",".diem-danh",function(e){e.preventDefault();var a=$(this);$.ajax({type:"POST",url:window._thanhdieu.ajax_user,data:{action:"diemdanh"},dataType:"json",success:function(e){e.success?(a.removeClass("diem-danh").removeAttr("data"),a.html('<i class="fa fa-calendar-check-o"></i> Đ\xe3 Điểm Danh'),notyf(e.message,"success")):notyf(e.message,"danger")},error:function(e,a,t){notyf("Mất kết nối đến m\xe1y chủ!","danger")},complete:function(){a.prop("disabled",!1)}}),a.html('<i class="loading mr3 c-yellow"></i><span class="loading-text c-yellow"> Vui l\xf2ng chờ</span>').prop("disabled",!0)}),n.ws.on("click",".user-verify-apply",function(e){$(".modal").not("#apply_verify_modal").modal("hide"),$("#apply_verify_modal").modal("show"),y()}),n.ws.on("submit",".auth-verify-from",function(e){e.preventDefault();var a=$(this);a.find('button[type="submit"]').html('<i class="loading mr3 c-yellow"></i><span class="loading-text c-yellow"> Đang Xử L\xfd</span>').prop("disabled",!0);var t=$(this).serialize();$.ajax({type:"POST",url:window._thanhdieu.ajax_user,data:t,dataType:"json",success:function(e){a.find('button[type="submit"]').html('<i class="fa fa-check" aria-hidden="true"></i> X\xe1c Nhận').prop("disabled",!1),e.success?($(".td-load-verify").load(location.href+" .td-load-verify > *"),$("#apply_verify_modal").modal("hide"),$("textarea[name='reason_desc']").val(""),notyf(e.message,"success")):notyf(e.error,"danger")},error:function(e,t,n){return a.find('button[type="submit"]').html('<i class="fa fa-check" aria-hidden="true"></i> X\xe1c Nhận').prop("disabled",!1),notyf("Mất kết nối đến m\xe1y chủ!","danger"),!1}})}),n.ws.on("click",".plans-buyer",function(e){e.preventDefault(),$(".tab-pane").removeClass("fade in active"),$(".td-1.relative,.td-2.relative").removeClass("active"),"1"===$(this).attr("vip-level")?($("#tab-payvip-1").addClass("fade in active"),$(".vip-cardminis li a[href='#tab-payvip-1']").attr("aria-expanded","true"),$(".td-1.relative").addClass("active")):($("#tab-payvip-2").addClass("fade in active"),$(".vip-cardminis li a[href='#tab-payvip-2']").attr("aria-expanded","true"),$(".td-2.relative").addClass("active")),$("#modal_pay_uservip").modal("show"),y()}),n.ws.on("submit",".user-rent-plans-legacy",function(e){e.preventDefault(),j($(this).serialize())}),n.ws.on("submit",".user-rent-plans-premium",function(e){e.preventDefault(),j($(this).serialize())}),n.ws.on("click",".user-follow-author",function(e){e.preventDefault();var a=$(this).data("pid"),t=$(this).data("puser"),n=$(this).find("count"),s=n.html();n.html('<i class="loading zts"></i>'),$.ajax({url:window._thanhdieu.ajax_user,method:"POST",dataType:"json",data:{ws_follow_user:!0,userID:a,username:t},success:function(e){e.success?(n.html('<i class="ri-user-follow-line"></i> Đang theo d\xf5i'),notyf(e.message,"success")):(n.html('<i class="ri-user-add-line"></i> Theo d\xf5i'),notyf(e.message,"danger"))},error:function(e,a,t){n.html(s),notyf("Lỗi khi theo d\xf5i người d\xf9ng n\xe0y!","danger")}})}),$(".vtd-rspass").addClass("change-show").hide(),$('input[change-show=".change-show"]').on("input",function(){""!==$(this).val()&&/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test($(this).val())?$(".vtd-rspass").addClass("change-show").slideDown():$(".vtd-rspass").removeClass("change-show").slideUp()}),n.ws.on("click",".verification-submit",function(e){e.preventDefault();var a=$(this);a.html('<i class="loading mr3 c-blue"></i><span class="loading-text c-blue"> Vui l\xf2ng chờ</span>').prop("disabled",!0);var t=$("input[name='email']").val();initGeetest4({product:"bind",captchaId:b},function(e){e.onReady(function(){e.showCaptcha()}),e.onSuccess(function(){$.ajax({type:"POST",url:window._thanhdieu.ajax_user,data:{email:t,action:"send_code"},dataType:"json",success:function(e){var t,n,s,i;a.html("Gửi m\xe3 x\xe1c minh").prop("disabled",!1),e.success?(notyf(e.message,"success"),(e.expires_at||e.remaining_time)&&(t=e.expires_at,n=e.remaining_time,s=a,s.html('<i class="loading mr3 c-blue"></i><span class="loading-text c-blue"> Vui l\xf2ng chờ</span>').prop("disabled",!0),t?i=setInterval(function(){var e=Math.floor((new Date(t).getTime()-new Date().getTime())/1e3);e<=0?(clearInterval(i),s.html("Gửi m\xe3 x\xe1c minh").prop("disabled",!1)):s.html("Gửi lại sau "+e+" gi\xe2y").prop("disabled",!0)},1e3):n&&(i=setInterval(function(){var e=Math.floor((new Date(1e3*n).getTime()-new Date().getTime())/1e3);e<=0?(clearInterval(i),s.html("Gửi m\xe3 x\xe1c minh").prop("disabled",!1)):s.html("Gửi lại sau "+e+" gi\xe2y").prop("disabled",!0)},1e3)))):e.error&&notyf(e.error,"danger")},error:function(e,t,n){a.html("Gửi m\xe3 x\xe1c minh").prop("disabled",!1),notyf("Mất kết nối đến m\xe1y chủ!","danger")}})}),e.onError(function(){a.html("Gửi m\xe3 x\xe1c minh").prop("disabled",!1),notyf("X\xe1c thực captcha thất bại!","danger")}),e.onClose(function(){a.html("Gửi m\xe3 x\xe1c minh").prop("disabled",!1),notyf("Bạn đ\xe3 huỷ bỏ x\xe1c minh captcha!","warning")})})}),$("input[name='email'], input[name='code']").on("input",function e(){var a=$("input[name='email']").val().trim(),t=$("input[name='code']").val().trim();$(".rssubmit-loader").prop("disabled",!(/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(a)&&""!==t))}),n.ws.on("click",".rssubmit-loader",function(e){e.preventDefault();var a=$("input[name='email']").val(),t=$("input[name='code']").val();initGeetest4({product:"bind",captchaId:b},function(e){e.onReady(function(){e.showCaptcha()}),e.onSuccess(function(){$.ajax({type:"POST",url:window._thanhdieu.ajax_user,data:{email:a,code:t,action:"user_reset_pass"},dataType:"json",success:function(e){e.success?notyf(e.message,"success"):notyf(e.error,"danger")},error:function(e,a,t){return notyf("Mất kết nối đến m\xe1y chủ!","danger"),!1}})}),e.onError(function(){notyf("X\xe1c thực captcha thất bại!","danger")}),e.onClose(function(){notyf("Bạn đ\xe3 huỷ bỏ x\xe1c minh captcha!","warning")}),$("<button>Td</button>").click(function(){e.showCaptcha()})})}),$('textarea[name="desc"]').attr("maxlength",70).on("input",function(){$("[data-text-limit]").text(70-$(this).val().length)}).trigger("input"),n.ws.on("submit",".td-report-user",function(e){e.preventDefault();var a=$(this),t=a.find('button[type="submit"]'),n=a.find(".preview-item img"),s=a.find(".report-profile-link").attr("href")?a.find(".report-profile-link").attr("href").split("/")[2].replace("@",""):null;if(0===n.length){notyf("Cần cung cấp h\xecnh ảnh bằng chứng trước!","warning");return}f.TD(t);var i=new FormData;a.find("input, textarea").each(function(){i.append($(this).attr("name"),$(this).val())}),n.each(function(e,a){for(var t=$(a).attr("src").split(","),n=t[0].match(/:(.*?);/)[1],s=atob(t[1]),o=s.length,c=new Uint8Array(o);o--;)c[o]=s.charCodeAt(o);var r=new Blob([c],{type:n});i.append("image_upload[]",r,"image"+e+".png")}),i.append("victim",s),$.ajax({type:"POST",url:window._thanhdieu.ajax_user,data:i,processData:!1,contentType:!1,dataType:"json",success:function(e){t.html('<i class="fa fa-check"></i>X\xe1c Nhận').prop("disabled",!1),"show"===e.modal?($(".modal:not(#report_notice)").modal("hide"),$("#report_notice").modal("show")):e.success?($(".modal:not(#report_notice)").modal("hide"),$("#report_notice").modal("show"),notyf(e.message,"success")):notyf(e.error,"danger")},error:function(e,a,n){t.html('<i class="fa fa-check"></i>X\xe1c Nhận').prop("disabled",!1),notyf("Mất kết nối đến m\xe1y chủ!","danger")}})}),n.ws.on("click",".tab-system",function(){var e=$(this).data("id");$.ajax({url:window._thanhdieu.ajax_user,type:"POST",data:{notification_system:!0,id:e},beforeSend:function(){$("#msg-tab-system").show(),$(".msg-list-container").hide(),C(!0)},success:function(e){try{var a=JSON.parse(e);!1===a.success&&notyf(a.message,"danger")}catch(t){$("#msg-tab-system").html(e)}},complete:function(){C(!1)},error:function(e,a,t){notyf("Mất kết nối đến m\xe1y chủ!","danger"),C(!1)}})}),n.ws.on("click",".back-msg",function(){$("#msg-tab-system").hide(),$(".msg-list-container").show(),C(!0)}),n.ws.on("click",".action-dohot",function(e){e.preventDefault();var a=$(this),t=a.data("username");let n=a.find(".icon"),s=$('<span class="plus-one">+1</span>');a.css("position","relative").append(s),n.addClass("clicked"),s.on("animationend",function(){$(this).remove()}),setTimeout(function(){n.removeClass("clicked")},100),$.ajax({url:window._thanhdieu.ajax_user,method:"POST",dataType:"json",data:{action:"dohot",author:t},success:function(e){$(".tag-hot").html('<i class="ri-fire-line"></i> '+e.dohot)},error:function(e){notyf("Mất kết nối đến m\xe1y chủ!","danger"),console.error("Error:",e)}})}),$(".order-product").submit(function(e){if(e.preventDefault(),!$(".sodu").is(":visible")){notyf("Vui l\xf2ng chọn phương thức thanh to\xe1n!","warning");return}var a=$(this);a.find('button[type="submit"]').html('<i class="loading mr3 c-yellow"></i><span class="loading-text c-yellow"></span>').prop("disabled",!0);var t=$(this).serialize();$.ajax({type:"POST",url:window._thanhdieu.ajax_user,data:t,dataType:"json",success:function(e){a.find('button[type="submit"]').text("Thanh To\xe1n Ngay").prop("disabled",!1),e.success?(notyf(e.message,"success"),$(".name-client").html("<b>Kh\xe1ch h\xe0ng:</b> "+e.hovaten),$(".giamua").html("<b>Th\xe0nh tiền:</b> "+e.giamua),$(".ngaymua").html("<b>Ng\xe0y mua:</b> "+e.ngaymua),$(".dl-product").attr("href","/goto?url="+btoa(e.download).replace(/={1,2}$/,"")).attr("target","_blank"),$(".modal:not(#order-notification)").modal("hide"),$("#order-notification").modal("show"),$(".sodu").load(location.href+" .sodu > *")):notyf(e.error,"danger")},error:function(e,t,n){return a.find('button[type="submit"]').text("Thanh To\xe1n Ngay").prop("disabled",!1),notyf("Mất kết nối đến m\xe1y chủ!","danger"),!1}})}),$("#product-list-2")&&$("#author-tab-follow").length){var O=window.location.pathname.split("/").pop().replace("@","");$(".td-tab-profile a").click(function(e){e.preventDefault(),$(".td-tab-profile li").removeClass("active"),$(this).parent().addClass("active");var a,t=$(this).data("target-td");if($(".tab-pane").removeClass("in active"),"#author-tab-post"===t){var n=$(".post-approved").data("xetduyet");S(1,"date",n,O)}else"#author-tab-follow"===t&&(a=O,$.ajax({url:window._thanhdieu.ajax_user,type:"POST",data:{profile_follower:!0,author:a},dataType:"json",beforeSend:function(){$("#author-tab-follow").html("");let e=1;for(;e<=4;)$("#author-tab-follow").append('<div class="author-minicard radius8 flex ac" style="display:inline-flex;margin:5px 8px"><div class="avatar-img mr10"><div class="avatar placeholder"></div></div><div class="flex1"><div class="placeholder k1 mb6"></div><i><i class="placeholder s1"></i><i class="placeholder s1 ml10"></i></i></div></div>'),e++},success:function(e){!0===e.success?($("#author-tab-follow").empty(),$("#author-tab-follow").append(e.total_fl),e.fl.forEach(function(e){$("#author-tab-follow").append(e)})):($("#author-tab-follow").empty(),$("#author-tab-follow").append(e.message))},complete:function(){},error:function(e,a,t){notyf("Lỗi! m\xe1y chủ từ chối kết nối.","danger")}}));$(t).addClass("in active")}),$("body").on("click","[data-xetduyet]",function(e){e.preventDefault(),$(".scroll-x [data-xetduyet]").removeClass("c-theme"),$(this).addClass("c-theme");var a=$(this).data("xetduyet"),t=$("#dropdown-menu").find(".active").attr("data-orderby");S(1,t,a,O)}),$(".td-dropdown li a").click(function(e){e.preventDefault(),$(this).parent().addClass("active").siblings().removeClass("active");var a=$(this).attr("data-orderby"),t=$(".scroll-x [data-xetduyet].c-theme").data("xetduyet");S(1,a,t,O),$(".td-xeptheo").text($(this).text())}),$('.scroll-x [data-xetduyet="1"]').addClass("c-theme"),S(1,"date","1",O)}if($(document).on("click",".ajax-pag .page-numbers",function(e){if(e.preventDefault(),$("#product-list").length){var a=$(this).attr("href");if(a){var t=a.split("=")[1],n=$(".index-tab li.active a").attr("href");n&&D(t,n.split("=")[1])}}if($("#product-list-2").length){var t=$(this).attr("href").split("=")[1],s=$("#dropdown-menu").find(".active").attr("data-orderby"),i=$(".post-approved").data("xetduyet");S(t,s,i,O)}}),$("#product-list").length){$(document).on("click",".index-tab a",function(e){e.preventDefault();var a=$(this).attr("href");if(a){var t=a.split("=")[1];$(".index-tab li").removeClass("active"),$(this).parent().addClass("active"),D(1,t)}}),$(document).on("click",".td-ajax-type",function(e){e.preventDefault();var a=$(this).data("type");$(".td-ajax-type").removeClass("focus-color"),$(this).addClass("focus-color");var t=$(".index-tab li.active a").attr("href");t&&D(1,t.split("=")[1],a)});var[L,P]=[new URLSearchParams(window.location.search).get("page")||1,new URLSearchParams(window.location.search).get("tab")||"index-main"];D(L,P)}function M(e,a,t){$.ajax({url:window._thanhdieu.ajax_user,type:"POST",data:{search_code:!0,page:e,tab:a,keywords:t},dataType:"json",beforeSend:function(){$("#code-content").html(""),$("#code-content").append('<div win-ajax-replace="search-key"><div class="badg">T\xecm kiếm [ <a href="#"><b class="search-key focus-color">'+t+'</b></a> ] tổng cộng<b class="focus-color"> 0 </b>m\xe3 nguồn</div></div>').html();let e=1;for(;e<=4;)$("#code-content").append($('<div id="product-placeholder" style="display:none;"><div class="posts-item card no-events-img"><div class="item-thumbnail"><div class="radius8 item-thumbnail placeholder"></div></div><div class="item-body"><h2 class="item-excerpt placeholder t1 item-heading"></h2><p class="mt10 placeholder k2"></p><i class="flex jsb"><i class="placeholder s1"></i><i class="placeholder s1 ml10"></i></i></div></div></div>').html()),e++},success:function(e){!0===e.success?($("#code-content").empty(),$("#code-content").append(e.message),e.products.forEach(function(e){$("#code-content").append(e)}),$(".ajax-pag-2").html(e.pagination).show()):$("#code-content").html("").append(e.message)},error:function(e,a,t){$("#code-content").html('<div class="f-not-found"><img src="/public/src/vtd/img/icon/no-found.png"><p class="mt20 em09 muted-3-color separator">Kh\xf4ng c\xf2n nội dung n\xe0o</p></div>'),notyf("Lỗi! m\xe1y chủ từ chối kết nối.","danger")}})}if($(document).on("click",".ajax-pag-2 .page-numbers",function(e){e.preventDefault();var a=$(this).attr("href");if(a){var t=a.split("=")[1],n=$(".author-tab li.active a").attr("href");if(n){var s=new URLSearchParams(new URL(n,window.location.origin).search).get("type");M(t,s,$('input[name="q"]').val())}}}),$(".search-content").length){var E=new URLSearchParams(window.location.search),H=E.get("type")&&["code","user","forum"].includes(E.get("type"))?E.get("type"):"code";$(".td-ajax-search").each(function(){$(this).data("type")===H?$(this).parent().addClass("active"):$(this).parent().removeClass("active")});let z={code:M,user:function e(a,t,n){$.ajax({url:window._thanhdieu.ajax_user,type:"POST",data:{search_user:!0,page:a,keywords:n},dataType:"json",beforeSend:function(){$("#user-content").html(""),$("#user-content").append('<div win-ajax-replace="search-key"><div class="badg">T\xecm kiếm [ <a href="#"><b class="search-key focus-color">'+n+'</b></a> ] tổng cộng<b class="focus-color"> 0 </b>người d\xf9ng</div></div>');let e=1;for(;e<=6;)$("#user-content").append($('<div id="user-placeholder" style="display:none"><div class="author-minicard radius8 flex ac" style="display:inline-flex"><div class="avatar-img mr10"><div class="avatar placeholder"></div></div><div class="flex1"><div class="placeholder k1 mb6"></div><i><i class="placeholder s1"></i><i class="placeholder s1 ml10"></i></i></div></div></div>').html()),e++},success:function(e){!0===e.success?($("#user-content").empty(),e.user.length>0&&$("#user-content").append(`<div win-ajax-replace="search-key"><div class="badg">T\xecm kiếm [ <a href="#"><b class="search-key focus-color">${n||"Tất Cả"}</b></a> ] tổng cộng <b class="focus-color">${e.totalUsers}</b> người d\xf9ng</div></div>`),e.user.forEach(function(e){$("#user-content").append(e)})):($("#user-content").empty(),$("#user-content").append(`<div win-ajax-replace="search-key"><div class="badg">T\xecm kiếm [ <a href="#"><b class="search-key focus-color">${n||"Tất Cả"}</b></a> ] tổng cộng <b class="focus-color">0</b> người d\xf9ng</div></div>`),$("#user-content").append(e.message))},error:function(e,a,t){notyf("Lỗi! m\xe1y chủ từ chối kết nối.","danger")}})},forum:function e(a,t,n){console.log("Loading search for forum with page:",a,"type:",t,"keywords:",n)}};function I(e){z[e]||(e="code"),$(".td-tab-content").hide(),$("#"+e+"-content").show();var a,t=E.get("q").trim().replace(/[&<"']/g,e=>({"&":"&amp;","<":"&lt;",'"':"/","'":"/"})[e]||e)||"Tất Cả";z[e](1,e,t),"code"!==e&&$(".ajax-pag-2").hide()}if($(document).on("click",".td-ajax-search",function(e){e.preventDefault();var a=$(this).data("type");$(".td-ajax-search").parent().removeClass("active"),$(this).parent().addClass("active"),E.set("type",a);var t=window.location.pathname+"?"+E.toString();window.history.pushState({path:t},"",t),I(a)}),$(".dropdown-menu li").each(function(){$(this).data("value")===H&&($(this).addClass("active").siblings().removeClass("active"),$(".default-search").text($(this).find("a").text()))}),$(".dropdown-menu li a").click(function(){var e=$(this).data("value");E.set("type",e),$(this).parent().addClass("active").siblings().removeClass("active"),$(".default-search").html($(this).text())}),$("#code-content").length){var H=E.get("type")||"code";I(H)}}$("#forum").length&&$.ajax({url:window._thanhdieu.ajax_user,type:"POST",data:{main_forums:!0},dataType:"json",beforeSend:function(){$("#home-tab-1").html("");let e=1;for(;e<=4;)$("#home-tab-1").append($('<div id="forum-placeholder" style="display:none;"><posts class="forum-posts detail alone"><div class="user-info flex ac mb6"><div class="avatar-img"><div style="width:100%;height:100%" class="placeholder radius"></div></div><div class="flex1 ml10"><div class="placeholder k1" style="height:15px"></div><div class="placeholder s1 mt6"></div></div></div><h2 style="height:40px;margin-top:0" class="forum-title placeholder k2"></h2><div class="flex ac jsb mt10"><i><i class="placeholder s1"></i><i class="placeholder s1 ml10"></i></i><i><i class="placeholder s1 ml10"></i></i></div></posts></div>').html()),e++},success:function(e){!0===e.success?($("#home-tab-1").empty(),e.forums.forEach(function(e){$("#home-tab-1").append(e)})):($("#home-tab-1").html(""),$("#home-tab-1").append(e.message))},complete:function(){},error:function(e,a,t){notyf("Lỗi! m\xe1y chủ từ chối kết nối.","danger")}})}$(document).ready(ThanhDieuHandle);